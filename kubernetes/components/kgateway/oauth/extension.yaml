---
apiVersion: gateway.kgateway.dev/v1alpha1
kind: GatewayExtension
metadata:
  name: ${APP}-oauth
spec:
  oauth2:
    # Why is this required??
    backendRef:
      group: gateway.kgateway.dev
      kind: Backend
      name: ${APP}-oauth-backend
    issuerURI: "https://id.${SECRET_DOMAIN}"
    scopes: ["openid", "profile", "email", "groups"]
    credentials:
      clientID: "${CLIENT_ID:=${APP}}"
      clientSecretRef:
        name: ${APP}-oidc-credentials
    cookies:
      domain: "${SECRET_DOMAIN}"
