---
# yaml-language-server: $schema=https://datreeio.github.io/CRDs-catalog/postgresql.cnpg.io/pooler_v1.json
apiVersion: postgresql.cnpg.io/v1
kind: Pooler
metadata:
  name: ${APP}-pooler-rw
spec:
  cluster:
    name: ${APP}-db
  instances: ${CNPG_POOLER_REPLICAS:=1}
  type: rw
  pgbouncer:
    poolMode: "${CNPG_POOLMODE:=transaction}"
    parameters:
      default_pool_size: "30"
      min_pool_size: "5"
      reserve_pool_size: "10"
      reserve_pool_timeout: "5"
      max_client_conn: "500"
      listen_backlog: "1024"
      query_wait_timeout: "120"
      idle_transaction_timeout: "60"
      server_idle_timeout: "180"
      max_prepared_statements: "200"
