---
- source:
    kind: Kustomization
    fieldPath: metadata.name
    group: kustomize.toolkit.fluxcd.io
  targets:
    - select:
        kind: ClusterExternalSecret
        labelSelector: dormammu.io/component=cnpg
      fieldPaths:
        - metadata.name
        - spec.externalSecretSpec.secretStoreRef.name
      options:
        delimiter: "-"
        index: 0

    - select:
        kind: Cluster
      fieldPaths:
        - metadata.name
      options:
        delimiter: "-"
        index: 0

    - select:
        kind: Pooler
      fieldPaths:
        - metadata.name
        - spec.cluster.name
      options:
        delimiter: "-"
        index: 0
