---
# yaml-language-server: $schema=https://datreeio.github.io/CRDs-catalog/external-secrets.io/clusterexternalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ClusterExternalSecret
metadata:
  name: cluster-settings
  namespace: flux-system
spec:
  namespaceSelectors:
    - {} # all ns
  refreshTime: "1m"
  externalSecretSpec:
    secretStoreRef:
      kind: ClusterSecretStore
      name: onepassword-connect
    target:
      template:
        mergePolicy: Merge
        data:
          TZ: "America/Los_Angeles"
          # renovate: datasource=github-releases depName=siderolabs/talos
          TALOS_VERSION: "v1.12.4"
          # renovate: datasource=docker depName=ghcr.io/siderolabs/kubelet
          KUBE_VERSION: "v1.35.2"

          COREDNS_CLUSTER_IP: "172.17.0.10"
          BLOCKY_CLUSTER_IP: "172.17.0.11"
          K8S_GATEWAY_CLUSTER_IP: "172.17.0.13"

          SAMBA_LB_IP: "10.38.55.11"
          BLOCKY_LB_IP: "10.38.55.25"
          NFS_LB_IP: "10.38.55.30"
          D3SAVANT_LB_IP: "10.38.55.38"
          KGATEWAY_INTERNAL_LB_IP: "10.38.55.90"
          KGATEWAY_EXTERNAL_LB_IP: "10.38.55.91"
    dataFrom:
      - extract:
          key: cluster-secrets
