---
caching:
  minTime: 2m
  maxTime: 1h
  maxItemsCount: 0
  prefetching: true
  prefetchExpires: 1h
  prefetchThreshold: 30
  prefetchMaxItemsCount: 0
  cacheTimeNegative: -1

log:
  level: info

minTlsServeVersion: 1.3
ports:
  dns: 53
  tls: 853
  http: 4000

prometheus:
  enable: true
  path: /metrics

conditional:
  fallbackUpstream: true
  mapping:
    ${SECRET_DOMAIN}: ${K8S_GATEWAY_CLUSTER_IP}:53
    # DHCP servers
    # House
    house.lan: 10.10.10.2:53
    0.10.in-addr.arpa: 10.10.10.2:53
    # Apartment
    samthony.lan: 192.168.9.1:53
    168.192.in-addr.arpa: 192.168.9.1:53
    # kube
    cluster.local: ${COREDNS_CLUSTER_IP}
    16.172.in-addr.arpa: ${COREDNS_CLUSTER_IP}

clientLookup:
  upstream: 127.0.0.1
  clients:
    localhost:
      - 127.0.0.1

bootstrapDns:
  - https://1.1.1.1/dns-query

upstreams:
  groups:
    default:
      - https://cloudflare-dns.com/dns-query
      - https://dns.google/dns-query
      - https://dns.quad9.net/dns-query
      - https://dns.pub/dns-query

blocking:
  denylists:
    ads:
      - https://raw.githubusercontent.com/hagezi/dns-blocklists/main/wildcard/multi.txt
  allowlists:
    ads:
      - /allow.txt
  clientGroupsBlock:
    10.0.0.0/16:
      - ads
    192.168.1.0/24:
      - ads
    10.8.0.0/24:
      - ads

redis:
  address: dragonfly-db.dragonfly.svc.cluster.local:6379
  database: 4
  connectionCooldown: 5s


queryLog:
  type: postgresql
  logRetentionDays: 30
  creationAttempts: 5
  creationCooldown: 10s
  # optional: Which fields should be logged. You can choose one or more from: clientIP, clientName, responseReason, responseAnswer, question, duration. If not defined, it logs all fields
  fields:
    - clientIP
    - clientName
    - duration
    - question
    - responseReason
    - responseAnswer
