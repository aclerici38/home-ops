---
# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ./qbittorrent-secret.yaml
  - ../../../../templates/volsync/claim.yaml
  - ../../../../templates/volsync/minio.yaml
  - ./qbitrr-pvc.yaml
  - ./helmrelease.yaml
configMapGenerator:
  - name: qbitrr-config
    files:
      - ./config/qbitrr/config.toml
  - name: gluetun-config
    files:
      - ./config/gluetun/config.toml
generatorOptions:
  disableNameSuffixHash: true
replacements:
  - source:
      kind: Secret
      name: sonarr-secret
      fieldPath: data.SONARR_API_KEY
    targets:
      - select:
          kind: ConfigMap
          name: qbitrr-config
        fieldPaths:
          - data.config.toml
        options:
          delimiter: __SONARR_API_KEY__
          create: true
  - source:
      kind: Secret
      name: radarr-secret
      fieldPath: data.RADARR_API_KEY
    targets:
      - select:
          kind: ConfigMap
          name: qbitrr-config
        fieldPaths:
          - data.config.toml
        options:
          delimiter: __RADARR_API_KEY__
          create: true
