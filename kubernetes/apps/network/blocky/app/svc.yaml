---
apiVersion: v1
kind: Service
metadata:
  name: blocky-external
  annotations:
    lbipam.cilium.io/ips: "10.38.55.25"
spec:
  type: LoadBalancer
  externalTrafficPolicy: Local
  selector:
    app.kubernetes.io/instance: blocky
  ports:
    - name: dns-tcp
      protocol: TCP
      port: 53
      targetPort: 53
    - name: dns-udp
      protocol: UDP
      port: 53
      targetPort: 53
    - name: dns-tls
      protocol: TCP
      port: 853
      targetPort: 853
---
apiVersion: v1
kind: Service
metadata:
  name: blocky-internal
spec:
  clusterIP: 172.17.0.11
  selector:
    app.kubernetes.io/instance: blocky
  ports:
    - name: dns-tcp
      protocol: TCP
      port: 53
      targetPort: 53
    - name: dns-udp
      protocol: UDP
      port: 53
      targetPort: 53
    - name: dns-tls
      protocol: TCP
      port: 853
      targetPort: 853
---
apiVersion: v1
kind: Service
metadata:
  name: blocky-http
spec:
  selector:
    app.kubernetes.io/instance: blocky
  ports:
    - name: blocky-http
      protocol: TCP
      port: 4000
      targetPort: 4000
