---
controllers:
  main:
    containers:
      ${APP}:
        image:
          repository: redis/redisinsight
          tag: 2.66.0@sha256:e3af8fca1272243632adba175af4db0c439618f83649d8a12bbf617d3c9ff284
        env:
          RI_FILES_LOGGER: false
          RI_STDOUT_LOGGER: true
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities: { drop: ["ALL"] }
        resources:
          requests:
            cpu: 10m
            memory: 128Mi
          limits:
            memory: 512Mi
defaultPodOptions:
  securityContext:
    runAsNonRoot: true
    runAsUser: 65543
    runAsGroup: 65543
    fsGroup: 65543
    fsGroupChangePolicy: Always
    seccompProfile: { type: RuntimeDefault }
service:
  ${APP}:
    controller: main
    ports:
      http:
        port: &port 5540
route:
  ${APP}:
    hostnames:
      - ${APP}.${SECRET_DOMAIN}
    parentRefs:
      - name: internal
        namespace: kube-system
        sectionName: https
    rules:
      - backendRefs:
          - name: ${APP}
            port: *port
persistence:
  data:
    existingClaim: ${APP}
