---
apiVersion: kubevirt.io/v1
kind: VirtualMachine
metadata:
  name: windows-11
spec:
  runStrategy: Always
  template:
    spec:
      evictionStrategy: LiveMigrate
      domain:
        clock:
          timer:
            hpet:
              present: false
            hyperv: {}
            pit:
              tickPolicy: delay
            rtc:
              tickPolicy: catchup
          timezone: ${TZ}
        cpu:
          sockets: 1
          cores: 6
          threads: 1
          model: host-passthrough
        ioThreadsPolicy: auto
        memory:
          guest: 12Gi
        resources:
          requests:
            cpu: 512m
            memory: "12Gi"
          limits:
            cpu: "6"
            memory: "13Gi"
        devices:
          disks:
            - name: pvcdisk
              disk:
                bus: virtio
          interfaces:
            - masquerade: {}
              model: virtio
              name: default
              macAddress: 64:16:7F:30:13:EC
          tpm: {}
        features:
          acpi: {}
          apic: {}
          hyperv:
            relaxed: {}
            spinlocks:
              spinlocks: 8191
            vapic: {}
          smm: {}
        firmware:
          bootloader:
            efi:
              secureBoot: true
      networks:
        - name: default
          pod: {}
      terminationGracePeriodSeconds: 100
      volumes:
        - name: pvcdisk
          persistentVolumeClaim:
            claimName: windows-11
