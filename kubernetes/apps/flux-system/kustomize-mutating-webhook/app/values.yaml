---
image:
  repsotory: ghcr.io/xunholy/kustomize-mutating-webhook
  pullPolicy: IfNotPresent
replicas: 2
annotations:
  secret.reloader.stakater.com/reload: &sname cluster-secrets
certManager:
  enabled: true
configMaps:
  - create: true
    name: cluster-config
    optional: false
    data:
      TZ: "America/Los_Angeles"
      # renovate: datasource=docker depName=ghcr.io/siderolabs/installer
      TALOS_VERSION: v1.11.1
      # renovate: datasource=docker depName=ghcr.io/siderolabs/kubelet
      KUBE_VERSION: v1.34.1

      COREDNS_CLUSTER_IP: "172.17.0.10"
      BLOCKY_CLUSTER_IP: "172.17.0.11"
      DNSCRYPT_CLUSTER_IP: "172.17.0.12"
      K8S_GATEWAY_CLUSTER_IP: "172.17.0.13"

      NFS_IP: "192.168.9.25"
      BLOCKY_LB_IP: "10.38.55.25"
      D3SAVANT_LB_IP: "10.38.55.38"
      ENVOY_INTERNAL_LB_IP: "10.38.55.80"
      ENVOY_EXTERNAL_LB_IP: "10.38.55.81"

secrets:
  - create: false
    name: *sname
    optional: false
env:
  LOG_LEVEL: debug
service:
  headless: false
webhook:
  failurePolicy: Fail
  timeoutSeconds: 30
  namespaceSelector:
    matchExpressions:
      - key: kubernetes.io/metadata.name
        operator: NotIn
        values:
          - "flux-system"
podDisruptionBudget:
  enabled: false
securityContext:
  seccompProfile:
    type: RuntimeDefault
