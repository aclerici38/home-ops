---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: patch
spec:
  patches:
    # Fileflows doesn't allow db config via envs, set a static password to prevent rolling it on db restores
    - patch: |-
        apiVersion: postgresql.cnpg.io/v1
        kind: Cluster
        metadata:
          name: patch
        spec:
          bootstrap:
            initdb:
              database: app
              owner: fileflows
              secret:
                name: fileflows-secret
      target:
        kind: Cluster
